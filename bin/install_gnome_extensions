#!/usr/bin/bash

source "bin/_functions.bash"

if ask "Install Gnome Extension Manager?"; then
    flatpak install flathub com.mattjakeman.ExtensionManager
fi

if ask "Install Recommended Gnome Extensions?"; then
    extensions=(
        "sound-output-device-chooser@kgshank.net"
        "emoji-selector@maestroschan.fr"
        "bluetooth-quick-connect@bjarosze.gmail.com"
        "just-perfection-desktop@just-perfection"
    )

    for extension_id in ${extensions:@}; do
        out="/tmp/$extension_id.zip"
        wget -O "$out" "https://extensions.gnome.org/download-extension/$extension_id.shell-extension.zip"
        gnome-extensions install "$out"
    done
fi

if ask "Install Custom Gnome Extensions?"; then
    for extension_path in gnome/extensions/*; do
        extension_id=$(basename "$extension_path")
        echo "$extension_path"
        echo "$extension_id"
        gnome-extensions pack --force --out-dir="/tmp" "$extension_path" && \
        gnome-extensions install --force "/tmp/$extension_id.shell-extension.zip"
    done
fi
